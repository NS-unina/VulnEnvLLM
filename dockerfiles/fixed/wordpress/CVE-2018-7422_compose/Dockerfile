# Use the official WordPress image
FROM wordpress:latest

# Set environment variables
ENV WORDPRESS_DB_HOST=db \
    WORDPRESS_DB_USER=wordpress \
    WORDPRESS_DB_PASSWORD=wordpress \
    WORDPRESS_DB_NAME=wordpress

# Install necessary tools and dependencies
RUN apt-get update && \
    apt-get install -y unzip && \
    rm -rf /var/lib/apt/lists/*

# Download and install the Site Editor Plugin version 1.1.1
RUN curl -o /usr/src/wordpress/wp-content/plugins/site-editor.zip -SL https://downloads.wordpress.org/plugin/site-editor.1.1.1.zip && \
    unzip /usr/src/wordpress/wp-content/plugins/site-editor.zip -d /usr/src/wordpress/wp-content/plugins/ && \
    rm /usr/src/wordpress/wp-content/plugins/site-editor.zip

# Set ownership and permissions
RUN chown -R www-data:www-data /usr/src/wordpress/wp-content/plugins/site-editor

# Expose port 80 for web server
EXPOSE 80

# Start WordPress
CMD ["apache2-foreground"]