# Use a base image with necessary dependencies
FROM ubuntu:16.04

# Install necessary packages to build LibSSH
RUN apt-get update && apt-get install -y \
    build-essential \
    cmake \
    libssl-dev \
    zlib1g-dev \
    wget \
    tar

# Download LibSSH 0.7.5 source code
RUN wget https://www.libssh.org/files/0.7/libssh-0.7.5.tar.xz && \
    tar -xf libssh-0.7.5.tar.xz && \
    rm libssh-0.7.5.tar.xz

# Build and install LibSSH
WORKDIR /libssh-0.7.5
RUN mkdir build && cd build && \
    cmake .. && \
    make && \
    make install

# Copy and compile libssh_server.c file
COPY libssh_server.c /libssh-0.7.5
RUN gcc -o libssh_server libssh_server.c -lssh


EXPOSE 22
# Define entry point to start LibSSH server
# ENTRYPOINT ["./libssh_server"]
ENTRYPOINT ["tail", "-f", "/dev/null"]



# Expose necessary ports if applicable
# EXPOSE <port_number>

# Define entry point or default command if needed
# ENTRYPOINT ["executable"]