# Use the official PHP and Apache image
FROM php:7.4-apache

# Set the working directory to /var/www/html
WORKDIR /var/www/html

# Download and install dependencies
RUN apt-get update && \
    apt-get install -y unzip libpng-dev zlib1g-dev libxml2-dev && \
    rm -rf /var/lib/apt/lists/*

# Install required PHP extensions
RUN docker-php-ext-install gd json dom
# Download and install Bludit
RUN curl -o bludit.zip -SL https://github.com/bludit/bludit/archive/3.9.2.zip && \
    unzip bludit.zip && \
    rm bludit.zip && \
    mv bludit-3.9.2/* . && \
    rm -r bludit-3.9.2

# Set up permissions
RUN chown -R www-data:www-data /var/www/html && \
    chmod -R 755 /var/www/html

# Expose port 80
EXPOSE 80

# Start Apache
CMD ["apache2-foreground"]