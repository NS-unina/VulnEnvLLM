FROM nginx:latest

# Install system dependencies
RUN apt-get update && apt-get install -y php-fpm php-mysql php-mbstring php-curl zlib1g-dev libzip-dev unzip wget libpng-dev libxml2-dev php-dom php-gd php-json

# Create a working directory
WORKDIR /var/www/bludit

# Download Bludit and extract it
RUN wget https://github.com/bludit/bludit/archive/refs/tags/3.9.2.zip -O bludit-3.9.2.zip && \
    unzip bludit-3.9.2.zip && \
    rm bludit-3.9.2.zip

# Change ownership of Bludit directory
RUN chown -R www-data:www-data /var/www/bludit

# Expose Bludit port
EXPOSE 80

# Start Nginx and PHP-FPM
CMD ["nginx", "-g", "daemon off;"]