# Use the official Drupal image
FROM drupal:8.6.9

RUN echo "deb http://archive.debian.org/debian/ stretch main contrib non-free" > /etc/apt/sources.list && \
    echo "deb http://archive.debian.org/debian/ stretch-proposed-updates main contrib non-free" >> /etc/apt/sources.list && \
    echo "deb http://archive.debian.org/debian-security stretch/updates main contrib non-free" >> /etc/apt/sources.list
# Install dependencies
RUN apt-get --allow-unauthenticated update && \
    apt-get install -y --allow-unauthenticated mariadb-server && \
    apt-get clean && \
    rm -rf /var/lib/apt/lists/*

# Expose ports for Drupal and MariaDB
EXPOSE 80
EXPOSE 3306

# Define environment variables
ENV MYSQL_ROOT_PASSWORD=root
ENV MYSQL_DATABASE=drupal
ENV MYSQL_USER=drupal
ENV MYSQL_PASSWORD=drupal

# Start MariaDB service
RUN service mysql start

# Start Drupal service
CMD ["apache2-foreground"]