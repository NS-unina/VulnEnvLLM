# Use the official WordPress image
FROM wordpress:latest

# Set environment variables
ENV WORDPRESS_DB_HOST=localhost \
    WORDPRESS_DB_USER=root \
    WORDPRESS_DB_PASSWORD=password \
    WORDPRESS_DB_NAME=wordpress \
    HDW_PLAYER_VERSION=2.4.2

# Install dependencies
RUN apt-get update && apt-get install -y \
    wget \
    unzip

# Download and install HDW Player plugin
RUN wget -P /tmp https://downloads.wordpress.org/plugin/hdw-player.${HDW_PLAYER_VERSION}.zip \
    && unzip /tmp/hdw-player.${HDW_PLAYER_VERSION}.zip -d /usr/src/wordpress/wp-content/plugins/ \
    && rm /tmp/hdw-player.${HDW_PLAYER_VERSION}.zip

# Set permissions
RUN chown -R www-data:www-data /usr/src/wordpress/wp-content/plugins/hdw-player

# Cleanup
RUN apt-get clean \
    && rm -rf /var/lib/apt/lists/*

# Expose port
EXPOSE 80

# Start WordPress
CMD ["apache2-foreground"]