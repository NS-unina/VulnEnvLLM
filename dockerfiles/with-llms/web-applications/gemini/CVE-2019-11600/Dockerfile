FROM ubuntu:18.04

WORKDIR /opt/openproject

RUN apt-get update -y
RUN apt-get install -y curl wget unzip nodejs npm

# Download OpenProject archive
RUN curl -sO https://github.com/opf/openproject/releases/download/v8.3.1/openproject-community-8.3.1.tar.gz

# Extract OpenProject archive
RUN tar -zxvf openproject-community-8.3.1.tar.gz

# Install OpenProject dependencies
RUN npm install --production

# Copy OpenProject configuration
COPY openproject.yml /opt/openproject/config/openproject.yml

# Expose OpenProject ports
EXPOSE 8080
EXPOSE 80

# Start OpenProject
ENTRYPOINT ["./bin/openproject"]