# Use the official Drupal image
FROM drupal:8.6.9

# Install dependencies
RUN apt-get update && \
    apt-get install -y mariadb-server && \
    apt-get clean && \
    rm -rf /var/lib/apt/lists/*

# Copy custom Drupal configuration files if needed
# COPY config/some-config-file.ini /etc/some-config-file.ini

# Expose ports for Drupal and MariaDB
EXPOSE 80
EXPOSE 3306

# Define environment variables
ENV MYSQL_ROOT_PASSWORD=root
ENV MYSQL_DATABASE=drupal
ENV MYSQL_USER=drupal
ENV MYSQL_PASSWORD=drupal

# Start MariaDB service
RUN service mysql start

# CMD ["apache2-foreground"]  # Uncomment this if it's not already set in the base image

# Start Drupal service
CMD ["apache2-foreground"]